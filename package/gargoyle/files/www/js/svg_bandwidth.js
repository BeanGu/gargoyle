/*
	This program is copyright 2008,2009,2013 Eric Bishop and is distributed under the terms of the GNU GPL 
	version 2.0. 
	See http://gargoyle-router.com/faq.html#qfoss for more information
*/function init(e){svgDoc=e.target.ownerDocument,topCoor=1,leftCoor=1,rightCoor=800,bottomCoor=600;var t=Math.floor(rightCoor*85/100),n=Math.floor(bottomCoor*85/100),r=n-topCoor+1,i=1,s=window.innerHeight;s!=null&&(i=s/bottomCoor);var o=Math.ceil(1/i);minStrokeWidth=Math.ceil(.005*r),minStrokeWidth=minStrokeWidth<o?o:minStrokeWidth}function plotAll(e,t,n,r,i,s){if(svgDoc==null)return;topCoor=1,leftCoor=1,rightCoor=800,bottomCoor=600,t=parseInt(t),r=parseInt(r),i=parseInt(i),s!=null&&(tzMinutes=parseInt(s));var o=Math.floor(rightCoor*85/100),u=Math.floor(bottomCoor*85/100),a=u-topCoor+1,f=o-leftCoor+1,l=svgDoc.getElementById("graph-border");l.setAttribute("width",o),l.setAttribute("height",u),l.setAttribute("stroke","black"),l.setAttribute("stroke-width",minStrokeWidth);var c=getNextTick(n,1,r,1)-r,h=i-r,p=[h],d=r;while(p.length<t+1){var v=getNextTick(n,1,d,-1);p.unshift(d-v),d=v}var m=0,g=[];for(plotIndex=0;plotIndex<3;plotIndex++)if(e[plotIndex]!=null){var y=e[plotIndex],b=[];for(pointIndex=y.length-1;pointIndex>=0;pointIndex--){var w=p.length-[y.length-pointIndex];b[pointIndex]=p[w]>0&&""+parseFloat(y[pointIndex])!="NaN"?parseFloat(y[pointIndex])/p[w]:0,m=b[pointIndex]>m?b[pointIndex]:m}while(b.length<t+1)b.unshift(0);g[plotIndex]=b}var E=p[0],S=E>h?d+h:d+Math.floor(h*.95);p[0]=E>h?E-h:E-Math.floor(h*.95);var x=getMinIntervalSeconds(n),T=createXTicks(t,x,S,i,topCoor,u,leftCoor,o),N=createYTicks(T,m,leftCoor,o,topCoor,u);for(plotIndex=0;plotIndex<3;plotIndex++)if(g[plotIndex]!=null){var b=g[plotIndex],C=[],k=0,w;for(w=0;w<p.length;w++){var L=b[w];L=L==null?b[w-1]:L;var A=Math.floor(a*L/N);A=A==null||A+""=="NaN"?0:A,A=u-A;if(w==0){C.push(leftCoor+","+u),C.push(leftCoor+","+A);if(p[0]>E/2){var O=d-S+E/2,M=Math.floor(f*(O/(i-S)));M!="NaN"&&C.push(leftCoor+M+","+A)}k=p.length>1?p[0]+p[1]/2:p[0]}else if(w==p.length-1){if(p[w]>c/2){var O=r-S+c/2,M=Math.floor(f*(O/(i-S)));C.push(leftCoor+M+","+A)}C.push(o+","+A),C.push(o+","+u),C.push(leftCoor+","+u)}else{var M=Math.floor(f*(k/(i-S)));C.push(leftCoor+M+","+A),k=k+p[w]/2+p[w+1]/2}}svgDoc.getElementById("plot"+(plotIndex+1)).setAttribute("points",C.join(" ")),svgDoc.getElementById("plot"+(plotIndex+1)).setAttribute("stroke-width",minStrokeWidth)}else svgDoc.getElementById("plot"+(plotIndex+1)).setAttribute("points","")}function getMinIntervalSeconds(e){var t=60;return e=="second"?t=1:e=="minute"?t=60:e=="hour"?t=3600:e=="day"?t=86400:e=="month"?t=2419200:t=e,t}function createYTicks(e,t,n,r,i,s){var o,u,a=1024;e=="minute"?u="s":e=="hour"?u="s":e=="day"?(a/=3600,u="hr"):e=="month"&&(a/=86400,u="day"),maxRate=t/a,maxLog=Math.floor(Math.log(maxRate)/Math.log(10)),maxLogMultiple=1+Math.floor(maxRate/Math.pow(10,maxLog)),maxLogMultiple==10?(maxLogMultiple=1,maxLog+=1):maxLogMultiple==2&&2-maxRate/Math.pow(10,maxLog)>=.5&&(maxLogMultiple=1.5),maxLog<1&&(maxLog<0||maxLogMultiple<5)&&(maxLog=0,maxLogMultiple=5);var f,l;maxLog<3?(f="KByte",l=1):maxLog<6?(f="MByte",l=Math.pow(10,3)):maxLog<9?(f="GByte",l=Math.pow(10,6)):(f="TByte",l=Math.pow(10,9)),f=f+" / "+u;var c;maxLogMultiple>5?c=2*Math.pow(10,maxLog):maxLogMultiple>2?c=Math.pow(10,maxLog):c=.5*Math.pow(10,maxLog),yMax=maxLogMultiple*Math.pow(10,maxLog);var h=s-i;svgDoc.getElementById("y-unit-container").setAttribute("font-size",.07*h),svgDoc.getElementById("y-unit-path").setAttribute("d"," M "+(r+.2*h)+" "+Math.floor(.6*h)+" L "+(r+.2*h)+" "+0),yUnitEl=svgDoc.getElementById("y-units"),yUnitEl.firstChild.data=" ",yUnitEl.firstChild.data=f,nextTick=0,tickNum=1,tickPath="";while(nextTick<yMax)yCoor=s-Math.floor((s-i)*nextTick/yMax),nextTick!=0&&(tickPath=tickPath+"M "+n+" "+yCoor+" L "+r+" "+yCoor+" "),tickLabel=nextTick/l,labelElement=svgDoc.getElementById("ytick-label"+tickNum),labelElement.style.display="block",labelElement.setAttribute("x",r+.02*h),labelElement.setAttribute("y",yCoor),labelElement.setAttribute("font-size",.05*h+"px"),labelElement.firstChild.data="",labelElement.firstChild.data=tickLabel,nextTick+=c,tickNum++;while(tickNum<=7)labelElement=svgDoc.getElementById("ytick-label"+tickNum),labelElement.style.display="none",tickNum++;return svgDoc.getElementById("yticks").setAttribute("d",tickPath),svgDoc.getElementById("yticks").setAttribute("stroke-width",minStrokeWidth),a*maxLogMultiple*Math.pow(10,maxLog)}function createXTicks(e,t,n,r,i,s,o,u){function c(e){var t=1;while(a/(t*e)>6)t++;return t}var a=t*e,f="minute",l;a<14400?(f="minute",l=c(60)):a<345600?(f="hour",l=c(3600)):a<9676800?(f="day",l=c(86400)):a<116121600&&(f="month",l=c(2419200));var h=1/3;l==2&&(h=1),l>=3&&(h=Math.floor(l/3));var p=s-i,d=getNextTick(f,h,n,1),v="";while(d<r)xCoor=o+Math.floor((u-o)*(d-n)/(r-n)),v=v+"M "+xCoor+" "+i+" L "+xCoor+" "+s+" ",d=getNextTick(f,h,d,1);svgDoc.getElementById("x-minor-ticks").setAttribute("d",v),svgDoc.getElementById("x-minor-ticks").setAttribute("stroke-width",minStrokeWidth),majorPathString="",tickNum=1;var m=getNextTick(f,l,n,1);while(m<r&&tickNum<=10){xCoor=o+Math.floor((u-o)*(m-n)/(r-n)),majorPathString=majorPathString+"M "+xCoor+" "+(s+1)+" L "+xCoor+" "+(s+Math.floor(.02*(s-i)))+" ",tickLabel="",tickDate=new Date,tickDate.setTime(m*1e3),tickDate.setUTCMinutes(tickDate.getUTCMinutes()+tzMinutes),monthAbbreviations=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=="minute"||f=="hour"?tickLabel=tickDate.getUTCHours()+":"+(tickDate.getUTCMinutes()>=10?tickDate.getUTCMinutes():"0"+tickDate.getUTCMinutes()):f=="day"?tickLabel=monthAbbreviations[tickDate.getUTCMonth()]+" "+tickDate.getUTCDate():tickLabel=monthAbbreviations[tickDate.getUTCMonth()],labelElement=svgDoc.getElementById("major-xtick-label"+tickNum),labelElement.style.display="block",labelElement.setAttribute("x",xCoor),labelElement.setAttribute("y",s+Math.ceil(.07*(s-i))),labelElement.setAttribute("font-size",Math.ceil(.05*p)+"px"),labelElement.firstChild.data="",labelElement.firstChild.data=tickLabel;var g=getNextTick(f,l,m,1);m=g,tickNum++}while(tickNum<=10)tickLabelId="major-xtick-label"+tickNum,svgDoc.getElementById(tickLabelId).style.display="none",svgDoc.getElementById(tickLabelId).firstChild.data="",tickNum++;return svgDoc.getElementById("x-major-ticks").setAttribute("d",majorPathString),svgDoc.getElementById("x-major-ticks").setAttribute("stroke-width",minStrokeWidth),f}function getNextTick(e,t,n,r){r=r!=-1?1:-1;var i=new Date,s=new Date;i.setTime(n*1e3);var o=n;s.setTime(o*1e3),s.setUTCMinutes(s.getUTCMinutes()+tzMinutes),i.setUTCMinutes(i.getUTCMinutes()+tzMinutes);var u=null,a=null;e=="second"?(u=function(e){var t=new Date;return t.setTime(e.getTime()),t.setUTCSeconds(e.getUTCSeconds()+1*r),t},a=function(e,t){return e.getUTCSeconds()%t==0?!0:!1}):e=="minute"?(s.setUTCSeconds(0),u=function(e){var t=new Date;return t.setTime(e.getTime()),t.setUTCMinutes(e.getUTCMinutes()+1*r),t},a=function(e,t){return Math.floor(e.getTime()/(60*1e3))%t==0?!0:!1}):e=="hour"?(s.setUTCSeconds(0),s.setUTCMinutes(0),u=function(e){var t=new Date;return t.setTime(e.getTime()),t.setUTCHours(e.getUTCHours()+1*r),t},a=function(e,t){return Math.floor(e.getTime()/(60*60*1e3))%t==0?!0:!1}):e=="day"?(s.setUTCSeconds(0),s.setUTCMinutes(0),s.setUTCHours(0),u=function(e){var t=new Date;return t.setTime(e.getTime()),t.setUTCDate(e.getUTCDate()+1*r),t},a=function(e,t){return Math.floor(e.getTime()/(24*60*60*1e3))%t==0?!0:!1}):e=="month"?(s.setUTCSeconds(0),s.setUTCMinutes(0),s.setUTCHours(0),s.setUTCDate(1),u=function(e){var t=new Date;return t.setTime(e.getTime()),t.setUTCMonth(e.getUTCMonth()+1*r),t},a=function(e,t){return(e.getUTCMonth()+12*parseInt(e.getUTCFullYear()))%t==0?!0:!1}):e=="year"?(s.setUTCSeconds(0),s.setUTCMinutes(0),s.setUTCHours(0),s.setUTCDate(1),s.setUTCMonth(0),u=function(e){var t=new Date;return t.setTime(e.getTime()),t.setUTCFullYear(e.getUTCFullYear()+1*r),t},a=function(e,t){return e.getUTCFullYear()%t==0?!0:!1}):parseInt(e)!="NaN"&&(u=function(t){var n=new Date;return n.setTime(t.getTime()+r*parseInt(e)*1e3),n},a=function(e,t){return!0});var f=0;while(s.getTime()<=i.getTime()&&r>0||s.getTime()>=i.getTime()&&r<0){if(t<1){var l=t*(u(s).getTime()-s.getTime());s.setTime(s.getTime()+Math.floor(l))}else{var c=Math.floor(t),h;s=u(s);for(h=0;h<c&&!a(s,t);h++)s=u(s)}f++;if(f>50+t)return alert("BAD BAD BAD!!!!!\nunit = "+e+"\ncurrentTime = "+n+", increment = "+l),s}return s.setUTCMinutes(s.getUTCMinutes()-tzMinutes),o=Math.floor(s.getTime()/1e3),o}var svgNs="http://www.w3.org/2000/svg",svgDoc,topCoor=1,leftCoor=1,rightCoor=800,bottomCoor=600,minStrokeWidth=1,tzMinutes=0;