/*
	This program is copyright 2008,2009,2013 Eric Bishop and is distributed under the terms of the GNU GPL 
	version 2.0. 
	See http://gargoyle-router.com/faq.html#qfoss for more information
*/function init(e){svgDoc=e.target.ownerDocument}function setPieChartData(e,t){if(svgDoc==null)return;pieChartLabels=[],labelX=1,nextLabelY=25,labelYIncrement=30,labelBoxWidth=15,colorIncrement=Math.ceil(360/e.length),color=[255,0,0],nextColorIncrement=0;for(labelIndex=0;labelIndex<t.length;labelIndex++){var n=getColorStr(incrementColor(color,nextColorIncrement)),r=getColorStr(getSelectedRgb(incrementColor(color,nextColorIncrement)));unselectedColors[labelIndex]=n,selectedColors[labelIndex]=r,labelRect=svgDoc.createElementNS(svgNs,"rect"),labelRect.setAttribute("x",labelX),labelRect.setAttribute("y",nextLabelY),labelRect.setAttribute("width",labelBoxWidth),labelRect.setAttribute("height",labelBoxWidth),labelRect.setAttribute("stroke","black"),labelRect.setAttribute("stroke-width","1"),labelRect.setAttribute("id","color_"+labelIndex),labelRect.setAttribute("fill",n),labelText=svgDoc.createElementNS(svgNs,"text"),labelText.setAttribute("x",labelX+25),labelText.setAttribute("y",nextLabelY+labelBoxWidth),labelText.setAttribute("font-size",Math.floor(labelBoxWidth*.66)+"px"),labelText.setAttribute("font-family","serif"),labelText.appendChild(svgDoc.createTextNode(t[labelIndex])),labelText.setAttribute("id","label_"+labelIndex),selectedId==labelIndex&&(labelRect.setAttribute("stroke-width",3),labelText.setAttribute("font-weight","bolder"),labelRect.setAttribute("fill",r)),labelGroup=svgDoc.createElementNS(svgNs,"g"),labelGroup.setAttribute("id","group_"+labelIndex),labelGroup.appendChild(labelRect),labelGroup.appendChild(labelText),labelGroup.onmouseover=piePieceSelected,labelGroup.onmouseout=piePieceDeselected,pieChartLabels.push(labelGroup),nextColorIncrement+=colorIncrement,nextLabelY+=labelYIncrement}centerX=325,centerY=150,radius=125,dataSum=0;for(dataIndex=0;dataIndex<e.length;dataIndex++)dataSum+=e[dataIndex];colorIncrement=Math.ceil(360/e.length),color=[255,0,0],nextColorIncrement=0,pieChartPaths=[],radiansPlotted=0,previousX=centerX+radius*Math.cos(radiansPlotted),previousY=centerY+ -1*radius*Math.sin(radiansPlotted);for(dataIndex=0;dataIndex<e.length;dataIndex++){angle=radiansPlotted+2*Math.PI*e[dataIndex]/dataSum,x=centerX+radius*Math.cos(angle),y=centerY+ -1*radius*Math.sin(angle),xDiff=x-previousX,yDiff=y-previousY,largeArc=angle-radiansPlotted>Math.PI?1:0,defaultPathData="M "+centerX+","+centerY+" L "+previousX+","+previousY+" a"+radius+","+radius+" 0 "+largeArc+",0 "+xDiff+","+yDiff+" z";var i;e[dataIndex]==dataSum?(i=svgDoc.createElementNS(svgNs,"circle"),i.setAttribute("r",radius),i.setAttribute("cx",centerX),i.setAttribute("cy",centerY)):(i=svgDoc.createElementNS(svgNs,"path"),i.setAttribute("d",defaultPathData),i.setAttribute("stroke-linejoin","round")),i.setAttribute("fill",unselectedColors[dataIndex]),i.setAttribute("stroke","black"),i.setAttribute("stroke-width","1"),i.setAttribute("id","slice_"+dataIndex),selectedId==dataIndex&&(i.setAttribute("stroke-width","3"),i.setAttribute("fill",selectedColors[dataIndex])),i.onmouseover=piePieceSelected,i.onmouseout=piePieceDeselected,pieChartPaths.push(i),previousX=x,previousY=y,radiansPlotted=angle,nextColorIncrement+=colorIncrement}pieContainer=svgDoc.getElementById("pie_container"),labelContainer=svgDoc.getElementById("label_container");while(labelContainer.firstChild!=null)labelContainer.removeChild(firstChild);while(pieContainer.firstChild!=null)pieContainer.removeChild(pieContainer.firstChild);for(pathIndex=0;pathIndex<pieChartPaths.length;pathIndex++)pathIndex<pieChartLabels.length&&pieContainer.appendChild(pieChartLabels[pathIndex]),pieContainer.appendChild(pieChartPaths[pathIndex])}function piePieceSelected(){id=this.id.match(/_(.*)$/)[1],selectedId=id,svgDoc.getElementById("color_"+id).setAttribute("stroke-width",3),svgDoc.getElementById("color_"+id).setAttribute("fill",selectedColors[id]),svgDoc.getElementById("label_"+id).setAttribute("font-weight","bolder"),slice=svgDoc.getElementById("slice_"+id),slice.setAttribute("stroke-width","3"),slice.setAttribute("fill",selectedColors[id]),pieContainer=svgDoc.getElementById("pie_container"),pieContainer.removeChild(slice),pieContainer.appendChild(slice)}function piePieceDeselected(){id=this.id.match(/_(.*)$/)[1],id==selectedId&&(selectedId=null),svgDoc.getElementById("color_"+id).setAttribute("stroke-width","1"),svgDoc.getElementById("color_"+id).setAttribute("fill",unselectedColors[id]),svgDoc.getElementById("label_"+id).setAttribute("font-weight","normal"),slice=svgDoc.getElementById("slice_"+id),slice.setAttribute("stroke-width","1"),slice.setAttribute("fill",unselectedColors[id]),pieContainer=svgDoc.getElementById("pie_container"),pieContainer.removeChild(slice),pieContainer.appendChild(slice)}function getSelectedRgb(e){var t=[],n=0;for(n=0;n<3;n++){var r=e[n];r=Math.ceil(r*.45),t[n]=r}return t}function incrementColor(e,t){function n(t,n){return e[t]==e[n]?n-t:e[t]-e[n]}indices=[0,1,2],indices.sort(n),max=e[indices[2]],min=e[indices[0]],middle=e[indices[1]],difference=max-min,t%=360,fullTurnDistance=6*difference,incrementDistance=t*fullTurnDistance/360,newRgb=[e[0],e[1],e[2]],lowIndex=indices[0],middleIndex=indices[1],highIndex=indices[2];while(incrementDistance>0)incrementDistance<newRgb[highIndex]-newRgb[middleIndex]?(newRgb[middleIndex]=middle+incrementDistance,incrementDistance=0):(incrementDistance-=newRgb[highIndex]-newRgb[middleIndex],newRgb[middleIndex]=max,subtractIncrement=incrementDistance<difference?incrementDistance:difference,newRgb[highIndex]=newRgb[highIndex]-subtractIncrement,incrementDistance-=subtractIncrement,oldHighIndex=highIndex,highIndex=middleIndex,middleIndex=lowIndex,lowIndex=oldHighIndex);return newRgb}function getColorStr(e){function t(e){return e<16?"0"+Math.floor(e).toString(16):Math.floor(e).toString(16)}return"#"+t(e[0])+t(e[1])+t(e[2])}var svgNs="http://www.w3.org/2000/svg",svgDoc,selectedId=null,unselectedColors=[],selectedColors=[];